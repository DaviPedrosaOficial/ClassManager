<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:ClassManager.ViewModels"
             x:DataType="vm:MainPageViewModel"
             x:Class="ClassManager.MainPage">

    <NavigationPage.TitleView>
        <Label Text="Home" VerticalTextAlignment="Center" HorizontalTextAlignment="Center" FontSize="Title" FontAttributes="Bold"/>
    </NavigationPage.TitleView>

    <ContentPage.Background>
        <LinearGradientBrush>
            <GradientStop Color="#1FFFD2" Offset="0.2"/>
            <GradientStop Color="#1FBCFF" Offset="0.5"/>
            <GradientStop Color="#1F4CFF" Offset="1.0"/>
        </LinearGradientBrush>
    </ContentPage.Background>

    <Grid RowDefinitions="50, 3*, *"
              Margin="15"
              Padding="10">

        <Label Text="Minhas Instituições :"
                   FontSize="Subtitle"
                   FontAttributes="Bold"/>

        <Border Grid.Row="1"
               BackgroundColor="Transparent"
                Stroke="#1F4CFF"
                StrokeThickness="2">
            <CollectionView x:Name="cv_instituicoes"
                            ItemsSource="{Binding Instituicoes}"
                            SelectionChangedCommand="{Binding ItemSelecionadoCommand}">
                <CollectionView.EmptyView>

                    <Label Text="Você ainda não possui instituições cadastradas"
                           HorizontalOptions="Center"
                           VerticalOptions="Center"
                           FontAttributes="Bold"
                           Margin="10"/>

                </CollectionView.EmptyView>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border Margin="1,2"
                                HorizontalOptions="Fill"
                                BackgroundColor="#1FBCFF"
                                Stroke="#1F4CFF"
                                StrokeThickness="2">
                            
                            <Label Text="{Binding Nome}"
                               FontSize="Medium"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center"
                               Margin="10"/>
                            <Border.GestureRecognizers>
                                <TapGestureRecognizer 
                                    Command="{Binding BindingContext.ItemSelecionadoCommand, Source={x:Reference cv_instituicoes}}"
                                    CommandParameter="{Binding .}"/>
                            </Border.GestureRecognizers>

                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Border>

        <VerticalStackLayout Margin="0, 20"
                             Spacing="15"
                             Grid.Row="2">

            <Button Text="Adicionar instituição"
                    TextColor="Black"
                    FontAttributes="Bold"
                    Command="{Binding RedirecionarPaginaAddInstituicao}"/>

            <Button Text="Deslogar"
                    TextColor="Black"
                    FontAttributes="Bold"
                    Command="{Binding DeslogarUsuario}"/>

        </VerticalStackLayout>

    </Grid>

</ContentPage>
